项目存在的问题和因为这些问题需要的解决的痛点

问题：

1、项目太大，参与的人员很多，功能点很多，一个小功能修改补就需要上一个全新版本。

2、有时候需要别的部门的人在我们的项目代码上开发，这样导致代码管理难，开发收现在受限（把自己的代码暴露给别人开发，不优雅也很不协调）

3、功能齐备，但是客户只需要我们系统中的个别功能，如果因为一个功能故障，导致整个系统访问不了，十分被动。

4、增量升级！在面对各种复杂场景时，我们通常很难对一个已经存在的系统做全量的技术栈升级或重构，而微前端是一种非常好的实施渐进式重构的手段和策略。

5、布局新的技术，对于特定的业务，新的技术可能会更加适配特定的业务，能独立出来与原有框架和体系，单独开发，技术栈无关

微前端概念：微前端（Micro-Frontends）是一种类似于微服务的架构，它将微服务的理念应用于浏览器端，即将 Web 应用由单一的单体应用转变为多个小型前端应用聚合为一的应用。各个前端应用还可以**独立运行、独立开发、独立部署**。

各个方案的比较：

| 方案               | 描述                                                         | 优点                                               | 缺点                                                         |
| ------------------ | ------------------------------------------------------------ | -------------------------------------------------- | ------------------------------------------------------------ |
| Nginx路由转发      | 通过Nginx配置反向代理来实现不同路径映射到不同应用，例如www.abc.com/app1对应app1，www.abc.com/app2对应app2，这种方案本身并不属于前端层面的改造，更多的是运维的配置。 | 简单，快速，易配置                                 | 在切换应用时会触发浏览器刷新，影响体验                       |
| iframe嵌套         | 父应用单独是一个页面，每个子应用嵌套一个iframe，父子通信可采用postMessage或者contentWindow方式 | 实现简单，子应用之间自带沙箱，天然隔离，互不影响   | iframe的样式显示、兼容性等都具有局限性；太过简单而显得low    |
| Web Components     | 每个子应用需要采用纯Web Components技术编写组件，是一套全新的开发模式 | 每个子应用拥有独立的script和css，也可单独部署      | 对于历史系统改造成本高，子应用通信较为复杂易踩坑             |
| 组合式应用路由分发 | 每个子应用独立构建和部署，运行时由父应用来进行路由管理，应用加载，启动，卸载，以及通信机制 | 纯前端改造，体验良好，可无感知切换，子应用相互隔离 | 需要设计和开发，由于父子应用处于同一页面运行，需要解决子应用的样式冲突，变量对象污染，通信机制等技术点 |



组合式应用路由方案：该方案的核心是“主从”思想，即包括一个基座（MainApp）应用和若干个微（MicroApp）应用，基座应用大多数是一个前端SPA项目，主要负责应用注册，路由映射，消息下发等，而微应用是独立前端项目，这些项目不限于采用React，Vue，Angular或者JQuery开发，每个微应用注册到基座应用中，由基座进行管理，但是如果脱离基座也是可以单独访问，基本的流程如下图所示：

![微前端1](C:\Users\96538\Desktop\微前端\微前端1.jpg)



最终效果图：

![微前端2](C:\Users\96538\Desktop\微前端\微前端2.jpg)

主应用作为整个系统的入口，负责承载当前微应用的展示和对其他路由微应用的转发。在主应用通过菜单可以在路由的分发下，无感切换到各个微应用，这些切换都是纯前端的，各个微应用脱离主应用也可以单独访问。



为什么选用qiankun?

在面对各种复杂场景时，我们通常很难对一个已经存在的系统做全量的技术栈升级或重构，而微前端是一种非常好的实施渐进式重构的手段和策略。

1、对主应用改造成本小，通过引入插件的方式，调用相对应api即可

2、套路和模块化开发。

3、微应用只需提供一个改造后的微应用脚手架即可在上面开发



微前端需要解决的问题：

1、跨域问题：微应用接口允许主应用跨域

> 主应用加载微应用，实际是通过fetch加载微应用资源，然后在主应用跑的。也就是说，主应用的地址是localhost:8888
>
> 微应用的地址是localhost:9999, 在主应用上加载微应用，微应用前端发出的请求实际是在主应用8888端口发出的，这里就存在跨域问题。即便微应用不是前后端分离的系统。

2、微应用的打包处理，

3、主应用和微应用的通讯，用于共享token等

4、主应用改造，引入乾坤依赖包，兼容ie